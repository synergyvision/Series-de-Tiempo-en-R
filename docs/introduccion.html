<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Series de Tiempo en R</title>
  <meta name="description" content="Series de Tiempo en R">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Series de Tiempo en R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://synergy.vision/Series-de-Tiempo-en-R/" />
  <meta property="og:image" content="http://synergy.vision/Series-de-Tiempo-en-R/images/cover.png" />
  
  <meta name="github-repo" content="synergyvision/Series-de-Tiempo-en-R/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Series de Tiempo en R" />
  
  
  <meta name="twitter:image" content="http://synergy.vision/Series-de-Tiempo-en-R/images/cover.png" />

<meta name="author" content="Synergy Vision">


<meta name="date" content="2018-03-20">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="acerca-del-autor.html">
<link rel="next" href="referencias.html">
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="https://cdn.datacamp.com/datacamp-light-latest.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><img src="images/logovision-black.png" width="160"></img></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefacio</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#por-que-leer-este-libro"><i class="fa fa-check"></i>¿Por qué leer este libro?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-libro"><i class="fa fa-check"></i>Estructura del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#informacion-sobre-los-programas-y-convenciones"><i class="fa fa-check"></i>Información sobre los programas y convenciones</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#practicas-interactivas-con-r"><i class="fa fa-check"></i>Prácticas interactivas con R</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#agradecimientos"><i class="fa fa-check"></i>Agradecimientos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="acerca-del-autor.html"><a href="acerca-del-autor.html"><i class="fa fa-check"></i>Acerca del Autor</a></li>
<li class="chapter" data-level="1" data-path="introduccion.html"><a href="introduccion.html"><i class="fa fa-check"></i><b>1</b> Introducción</a><ul>
<li class="chapter" data-level="1.1" data-path="introduccion.html"><a href="introduccion.html#conceptos-basicos"><i class="fa fa-check"></i><b>1.1</b> Conceptos básicos</a></li>
<li class="chapter" data-level="1.2" data-path="introduccion.html"><a href="introduccion.html#ejemplos"><i class="fa fa-check"></i><b>1.2</b> Ejemplos</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduccion.html"><a href="introduccion.html#clasificacion-de-las-series-de-tiempo"><i class="fa fa-check"></i><b>1.2.1</b> Clasificación de las series de tiempo</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduccion.html"><a href="introduccion.html#componentes-de-una-serie-de-tiempo"><i class="fa fa-check"></i><b>1.3</b> Componentes de una serie de tiempo</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduccion.html"><a href="introduccion.html#el-modelo-aditivo-de-componentes-de-series-de-tiempo"><i class="fa fa-check"></i><b>1.3.1</b> El Modelo Aditivo de Componentes de Series de Tiempo</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduccion.html"><a href="introduccion.html#el-modelo-multiplicativo-de-componentes-de-series-de-tiempo"><i class="fa fa-check"></i><b>1.3.2</b> El Modelo Multiplicativo de Componentes de Series de Tiempo</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduccion.html"><a href="introduccion.html#estimacion-de-la-tendencia"><i class="fa fa-check"></i><b>1.4</b> Estimación de la Tendencia</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduccion.html"><a href="introduccion.html#eliminacion-de-la-tendencia-en-ausencia-de-estacionalidad"><i class="fa fa-check"></i><b>1.4.1</b> Eliminación de la tendencia en ausencia de estacionalidad</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduccion.html"><a href="introduccion.html#eliminacion-de-la-tendencia-y-la-estacionalidad"><i class="fa fa-check"></i><b>1.5</b> Eliminación de la tendencia y la estacionalidad</a></li>
</ul></li>
<li class="appendix"><span><b>Apéndice</b></span></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Series de Tiempo en R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduccion" class="section level1">
<h1><span class="header-section-number">Capítulo 1</span> Introducción</h1>
<p>Las series de tiempo ya han desempeñado un papel importante en las primeras ciencias naturales. La astronomía babilónica utilizó series de tiempo de las posiciones relativas de estrellas y planetas para predecir eventos astronómicos. Las observaciones de los movimientos de los planetas formaron la base de las leyes que Johannes Kepler descubrió. El análisis de las series de tiempo ayuda a detectar las regularidades en las observaciones de una variable y a derivar “leyes” de ellas, y/o explotar toda la información incluida en esta variable para predecir mejor los desarrollos futuros. La idea metodológica básica detrás de estos procedimientos, que también eran válidos para los babilonios, es que es posible descomponer series de tiempos en un número finito de componentes independientes pero no directamente observables que se desarrollan regularmente y que por lo tanto pueden ser calculados de antemano. Para este procedimiento es necesario que existan diferentes factores independientes que incidan en la variable. A mediados del siglo XIX, este enfoque metodológico de la astronomía fue asumido por los economistas Charles Babbage y William Stanley Jevons. La descomposición en componentes no observados que dependen de diferentes factores causales, como suele emplearse en el análisis clásico de series de tiempo, fue desarrollada por Warren M. Persons (1919). Distinguía cuatro componentes diferentes:</p>
<ul>
<li><p>Desarrollo a largo plazo, tendencia,</p></li>
<li><p>Componente cíclico con períodos de más de un año, el ciclo económico,</p></li>
<li><p>Componente que contiene los altibajos dentro de un año, el ciclo estacional, y</p></li>
<li><p>Componente que contiene todos los movimientos que no pertenecen ni a la tendencia ni al ciclo económico ni al componente estacional, el residual.</p></li>
</ul>
<p>Suponiendo que los diferentes factores no observables son independientes, su recubrimiento aditivo genera las series de tiempo que, sin embargo, sólo podemos observar en su conjunto. Para obtener información sobre el proceso de generación de datos, tenemos que hacer suposiciones sobre sus componentes no observados. El análisis clásico de series de tiempo supone que los componentes sistemáticos, es decir, la tendencia, el ciclo económico y el ciclo estacional, no están influenciados por perturbaciones estocásticas y, por lo tanto, pueden representarse mediante funciones determinísticas del tiempo. El impacto estocástico se limita a los residuos, que, por otra parte, no contienen movimientos sistemáticos. Por lo tanto, se modela como una serie de variables aleatorias independientes o no correlacionadas con esperanza cero y varianza constante, es decir, como un proceso aleatorio puro.</p>
<p>Este enfoque cambió desde la presentación de los trabajos de George E. P. Box and Gwilym M. Jenkins, “Time Series Analysis: Forecasting and Control”, en los años 70 del siglo pasado. Se abandonaron los procedimientos puramente descriptivos del análisis clásico de series de tiempo y, en su lugar, se han utilizado los resultados y métodos de la teoría de la probabilidad y las estadísticas matemáticas. Desde ese entonces, el análisis de series ha tenido un desarrollo creciente. Se han presentado una gran variedad de libros sobre este tópico, cada uno de ellos influenciado principalmente por la orientación de las series que se discuten en sus contenidos. Una gran parte de la literatura está dirigida a exponer los aspectos teóricos alrededor de las series de tiempo, siendo en muchos casos, rigurosamente desarrollados y descritos, sin embargo poco de ellos presentan implementaciones de las técnicas estudiadas y su compresión en ejemplos reales lo que a veces puede dificultar su comprensión en especial para aquellos que no posean una apropiada formación matemática.</p>
<p>Los primeros intentos de estudiar el comportamiento de las series de tiempo financieras fueron realizados por profesionales financieros y periodistas en lugar de por académicos. De hecho, esto parece haberse convertido en una tradición de larga data, ya que, incluso hoy en día, gran parte de la investigación y el desarrollo empíricos todavía se originan en la propia industria financiera. Esto puede explicarse por el carácter práctico de los problemas, la necesidad de datos especializados y las posibles ventajas de dicho análisis. El primer y más conocido ejemplo de la investigación publicada sobre series de tiempo financieras es el legendario Charles Dow, como se expresa en sus editoriales en el Wall Street Times entre 1900 y 1902. Estos escritos formaron la base de la “teoría del Dow” e influyeron en lo que más tarde se conoció como análisis técnico y carisma. Aunque Dow no coleccionó y publicó sus editoriales por separado, esto fue hecho póstumamente por su seguidor Samuel Nelson (Nelson, 1902). Las ideas originales de Dow fueron posteriormente interpretadas y ampliadas por Hamilton (1922) y Rhea (1932). Estas ideas gozaron de cierto reconocimiento entre los académicos de la época: por ejemplo, Hamilton fue elegido miembro de la Royal Statistical Society.</p>
<p>Aunque Dow y sus seguidores discutieron muchas de las ideas que encontramos en el análisis moderno de finanzas y series de tiempo, incluyendo estacionalidad, eficiencia del mercado, correlación entre rendimiento de activos e índices, diversificación e imprevisibilidad, no hicieron ningún esfuerzo serio para adoptar métodos estadísticos formales. La mayor parte del análisis empírico consistió en la interpretación minuciosa de gráficos detallados de las medias bursátiles sectoriales, formando así los famosos índices Dow-Jones. Se argumentó que estos índices descuentan toda la información necesaria y proporcionan el mejor pronóstico de eventos futuros. Una idea fundamental, muy relevante para la teoría de los ciclos de Stanley Jevons y la metodología de descomposición de tendencias de la “curva Harvard A-B-C” de Warren Persons, fue que las variaciones de precios del mercado consistían en tres movimientos primarios: diarios, a medio y largo plazo.</p>
<p>La investigación empírica más temprana que utiliza métodos estadísticos formales se remonta a los documentos de Working (1934), Cowles (1933,1944) y Cowles and Jones (1937). El trabajo centró la atención en una característica previamente señalada de los precios de las materias primas y las acciones: que se asemejan a la acumulación de cambios puramente aleatorios. Alfred Cowles 3rd, analista financiero cuantitativamente entrenado y fundador de Econometric Society and the Cowles Foundation, investigó la habilidad de los analistas de mercado y servicios financieros para predecir los futuros cambios de precios, encontrando que había pocas pruebas de que pudieran hacerlo. Cowles y Jones reportaron evidencia de correlación positiva entre sucesivas variaciones de precios, pero, como posteriormente Cowles (1960) comentó, esto fue probablemente debido a que tomaron promedios mensuales de precios diarios o semanales antes de computar los cambios: un fenómeno de “correlación espuria”, analizado por Working (1960).</p>
<p>La previsibilidad de los cambios de precios se ha convertido desde entonces en un tema importante de la investigación financiera, pero, sorprendentemente, poco más se publicó hasta el estudio de Kendall (1953), en el que encontró que los cambios semanales en una amplia variedad de precios financieros no podían predecirse ni a partir de los cambios pasados en las series ni a partir de los cambios pasados en otras series de precios. Este parece haber sido el primer informe explícito de esta propiedad de los precios financieros a menudo citada, aunque la investigación sobre la previsibilidad de los precios sólo se vio impulsada por la publicación de los documentos de Roberts (1959) y Osborne (1959). El primero presenta un argumento en gran medida heurístico sobre por qué las sucesivas variaciones de precios deben ser independientes, mientras que el segundo desarrolla la proposición de que no se trata de cambios absolutos de precios, sino de cambios logarítmicos de precios independientes entre sí. Con la suposición auxiliar de que las propias modificaciones se distribuyen normalmente, esto implica que los precios se generan como movimiento Browniano.</p>
<p>El análisis de series de tiempo desempeña un papel importante en el análisis requerido para el pronóstico de eventos futuros. Existen varias formas o métodos de calcular cual va a ser la tendencia del comportamiento del proceso en estudio.</p>
<p>Un <strong>pronóstico</strong> es una predicción de algún evento o eventos futuros. Como sugirió Neils Bohr, hacer buenas predicciones no siempre es fácil. Los pronósticos famosamente “malos” incluyen lo siguiente del libro <em>“Malas Predicciones”</em>:</p>
<ul>
<li><p>“La población es de tamaño constante y se mantendrá hasta el fin de la humanidad.” La Enciclopedia, 1756.</p></li>
<li><p>“1930 será un espléndido año de empleo.” Departamento de Trabajo de los EE. UU., pronóstico de Año Nuevo en 1929, justo antes de que el mercado se desplomara el 29 de octubre.</p></li>
<li><p>“Las computadoras se multiplican a un ritmo rápido. Para el cambio de siglo habrá 220,000 en los EE. UU.” Wall Street Journal, 1966.</p></li>
</ul>
<p>Algunos ejemplos donde se puede utilizar y hacer precciones con series de tiempo:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Dirección de Operaciones</strong>. Las organizaciones empresariales utilizan habitualmente las previsiones de ventas de productos o la demanda de servicios para programar la producción, controlar los inventarios, gestionar la cadena de suministro, determinar las necesidades de personal y planificar la capacidad. Las previsiones también pueden utilizarse para determinar la combinación de productos o servicios que deben ofrecerse y las ubicaciones en las que deben fabricarse los productos.</p></li>
<li><p><strong>Marketing</strong>. La previsión es importante en muchas decisiones de marketing. Las previsiones de respuesta de las ventas a los gastos publicitarios, las nuevas romociones o los cambios en las políticas de precios permiten a las empresas evaluar su eficacia, determinar si se están alcanzando los objetivos y realizar ajustes.</p></li>
<li><p><strong>Finanzas y Gestión de Riesgos</strong>. Los inversores en activos financieros están interesados en pronosticar los rendimientos de sus inversiones. Estos activos incluyen, pero no se limitan a acciones, bonos y materias primas; otras decisiones de inversión se pueden tomar en relación con las previsiones de tasas de interés, opciones y tipos de cambio. La gestión del riesgo financiero requiere previsiones de la volatilidad de la rentabilidad de los activos para que se puedan evaluar y asegurar los riesgos asociados a las carteras de inversión, y para que los derivados financieros puedan cotizarse adecuadamente.</p></li>
<li><p><strong>Economía</strong>. Los gobiernos, las instituciones financieras y las organizaciones de política requieren pronósticos de las principales variables económicas, como el producto interno bruto, el crecimiento demográfico, el desempleo, las tasas de interés, la inflación, el crecimiento del empleo, la producción y el consumo. Estas previsiones son parte integrante de la orientación de la política monetaria y fiscal, así como de los planes y decisiones presupuestarias adoptadas por los gobiernos. También son fundamentales en las decisiones de planificación estratégica tomadas por organizaciones empresariales e instituciones financieras.</p></li>
<li><p><strong>Control de Procesos Industriales</strong>. Las previsiones de los valores futuros de las características de calidad crítica de un proceso de producción pueden ayudar a determinar cuándo deben cambiarse las variables controlables importantes del proceso, o si el proceso debe detenerse y revisarse. Los esquemas de retroalimentación y control feedforward son ampliamente utilizados en el monitoreo y ajuste de procesos industriales, y las predicciones de la producción del proceso son una parte integral de estos esquemas.</p></li>
<li><p><strong>Demografía</strong>. Las previsiones de población por país y región se realizan de manera rutinaria, a menudo estratificadas por variables como el género, la edad y la raza. Los demógrafos también pronostican nacimientos, muertes y patrones migratorios de las poblaciones. Los gobiernos utilizan estas previsiones para planificar políticas y acciones de servicio social, como el gasto en atención médica, programas de jubilación y programas de lucha contra la pobreza. Muchas empresas utilizan pronósticos de poblaciones por grupos de edad para hacer planes estratégicos en relación con el desarrollo de nuevas líneas de productos o tipos de servicios que será ofrecido.</p></li>
</ol>
<div id="conceptos-basicos" class="section level2">
<h2><span class="header-section-number">1.1</span> Conceptos básicos</h2>
<p>Una serie tiempo es una secuencia de observaciones, medidos en determinados momentos del tiempo, ordenados cronológicamente y, espaciados entre sí de manera uniforme, así los datos usualmente son dependientes entre sí. El principal objetivo de una serie de tiempo es su análisis para hacer pronóstico. Formalmente se tiene la siguiente definición.</p>

<div class="definition">
<p><span id="def:defi-serie-tiempo" class="definition"><strong>Definición 1.1  </strong></span>Una <strong>serie de tiempo</strong> es un conjunto de observaciones <span class="math inline">\(x_t\)</span>, cada una registrada a un tiempo específico <span class="math inline">\(t\)</span>.</p>
</div>


<div class="definition">
<span id="def:defi-modelo-serie-tiempo" class="definition"><strong>Definición 1.2  </strong></span>Un <strong>modelo de series de tiempo</strong> para los datos observados <span class="math inline">\(\{x_t\}\)</span> es una especificación de una distribución conjunta (o posiblemente solo de medias y covarianzas) de una sucesión de variables aleatorias <span class="math inline">\(\{X_t\}\)</span> de las cuales <span class="math inline">\(\{x_t\}\)</span> es una realización.
</div>

<p>A continuación presentaremos una serie de ejemplos que demuestran la utilidad y lo cotidiano de las series de tiempo, también se mostrarán los códigos en R para cargar los archivos de datos y graficar las respectivas series de tiempo.</p>
</div>
<div id="ejemplos" class="section level2">
<h2><span class="header-section-number">1.2</span> Ejemplos</h2>

<div class="example">
<p><span id="exm:ejem-beneficios-acciones" class="example"><strong>Ejemplo 1.1  </strong></span><strong>Beneficios de acciones.</strong> Beneficios por acción trimestrales para la compañía Johnson &amp; Johnson. Se tienen 84 trimestres iniciando el primer trimestre de 1960 hasta el último trimestre de 1980. Los métodos para analizar tales datos se verán en el Tema 3 usando técnicas de regresión. El archivo es <em>“jj.txt”</em>.</p>
Los comandos en R para cargar el archivo y graficar la serie de tiempo son los siguientes:
</div>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">jj=<span class="kw">ts</span>(<span class="kw">scan</span>(<span class="st">&quot;data/jj.txt&quot;</span>),<span class="dt">start=</span><span class="dv">1960</span>,<span class="dt">freq=</span><span class="dv">4</span>) 
<span class="kw">plot</span>(jj, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Beneficios por acción trimestrales&quot;</span>)</code></pre></div>
<p><img src="Serie-de-Tiempo-en-R_files/figure-html/unnamed-chunk-8-1.svg" /><!-- --></p>

<div class="example">
<span id="exm:reservas-internacionales" class="example"><strong>Ejemplo 1.2  </strong></span>El archivo <em>“ReservasInternacionales.xlsx”</em>, contiene el registro mensual de Reservas Internacionales Venezolanas en millones de dólares ($), iniciando en el mes de enero de 1996 hasta el mes de diciembre de 2017
</div>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#library(readxl)</span>
reservas &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;data/ReservasInternacionales.xlsx&quot;</span>)
reservas=<span class="kw">ts</span>(reservas,<span class="dt">start =</span> <span class="dv">1996</span>,<span class="dt">frequency =</span> <span class="dv">12</span>)
<span class="kw">plot.ts</span>(reservas[,<span class="dv">2</span>], <span class="dt">xlab=</span><span class="st">&quot;Año&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Monto&quot;</span>,
        <span class="dt">main=</span><span class="st">&quot;Reservas Internacionales de Venezuela (millones $)&quot;</span>)</code></pre></div>
<p><img src="Serie-de-Tiempo-en-R_files/figure-html/unnamed-chunk-9-1.svg" /><!-- --></p>

<div class="example">
<span id="exm:precio-petroleo" class="example"><strong>Ejemplo 1.3  </strong></span>El archivo <em>“PreciosPetroleoVzla.xlsx”</em> contiene el precio promedio mensual de venta para el petróleo venezolano (en dólares) desde enero 2006 hasta noviembre 2017
</div>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># library(readxl)</span>
petroleo &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;data/PreciosPetroleoVzla.xlsx&quot;</span>)
petroleo=<span class="kw">ts</span>(petroleo,<span class="dt">start =</span> <span class="dv">2006</span>,<span class="dt">frequency =</span> <span class="dv">12</span>)
<span class="kw">plot.ts</span>(petroleo[,<span class="dv">2</span>], <span class="dt">xlab=</span><span class="st">&quot;Año&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Monto&quot;</span>,
        <span class="dt">main=</span><span class="st">&quot;Precio promedio del petróleo venezolano (en dolares $)&quot;</span>)</code></pre></div>
<p><img src="Serie-de-Tiempo-en-R_files/figure-html/unnamed-chunk-10-1.svg" /><!-- --></p>

<div class="example">
<span id="exm:indice-dow-jones" class="example"><strong>Ejemplo 1.4  </strong></span>El archivo <em>“IndiceDowJones.xlsx”</em> contiene los valores histórico del índice Dow-Jones desde enero de 1930 hasta octubre de 2017. En el archivo podems notar que desde enero de 1930 hasta diciembre de 1994, los registros son el promedio semanal, a partir de enero de 1995, los registros son diarios. La primera columa es la fecha, la segunda columna es el valor de apertura, la tercera columna el valor máximo, la cuarta el valor mínimo, la quinta el último valor del índice o valor de cierre y la sexta columna es el volumen de acciones.
</div>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DJ=<span class="kw">read_excel</span>(<span class="st">&quot;data/IndiceDowJones.xlsx&quot;</span>)
DJ=<span class="kw">ts</span>(DJ)
<span class="kw">plot.ts</span>(DJ[,<span class="op">-</span><span class="dv">1</span>], <span class="dt">xlab=</span><span class="st">&quot;Días&quot;</span>,
        <span class="dt">main=</span><span class="st">&quot;Índice Dow-Jones desde enero 1930 hasta octubre 2017&quot;</span>)</code></pre></div>
<p><img src="Serie-de-Tiempo-en-R_files/figure-html/unnamed-chunk-11-1.svg" /><!-- --></p>

<div class="example">
<span id="exm:Bolsa-Valores-New-York" class="example"><strong>Ejemplo 1.5  </strong></span>La figura siguiente muestra los porcentajes de cambio diario de la Bolsa de Valores de New York desde el 2 de febrero de 1984 hasta el 31 de diciembre de 1991. Como se ve hay una caída fuerte, esta ocurrió el 19 de octubre de 1987 en <span class="math inline">\(t=938\)</span>. El archivo de datos es <em>“nyse.txt”</em>.
</div>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">NYSE=<span class="kw">ts</span>(<span class="kw">scan</span>(<span class="st">&quot;data/nyse.txt&quot;</span>))
<span class="kw">plot</span>(NYSE,<span class="dt">xlab=</span><span class="st">&quot;Tiempo&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Porcentaje de cambio, NYSE&quot;</span>)</code></pre></div>
<p><img src="Serie-de-Tiempo-en-R_files/figure-html/unnamed-chunk-12-1.svg" /><!-- --></p>
<div id="clasificacion-de-las-series-de-tiempo" class="section level3">
<h3><span class="header-section-number">1.2.1</span> Clasificación de las series de tiempo</h3>
<p>Como se ha mostrado en los ejemplos anteriores, hay una amplia variedad de series de tiempo que pueden clasificarse en varias categorías desde varios puntos de vista.</p>
<ul>
<li><p><strong>Series de tiempo continuas y discretas</strong>. Los datos registrados continuamente, por ejemplo, por un dispositivo analógico, se denominan series de tiempo continuas. Por otra parte, los datos observados en ciertos intervalos de tiempo, como la presión atmosférica medida cada hora, se denominan series de tiempo discretas. Existen dos tipos de series de tiempo discretas: una en la que las observaciones de los datos se realizan a intervalos de igual espaciamiento y otra en la que las observaciones de los datos se realizan a intervalos de espaciamiento desigual. Aunque las series de tiempo mostradas en los ejemplos anteriores están conectadas continuamente por líneas sólidas, todas ellas son series de tiempo discretas. A partir de ahora en este libro, consideramos sólo discretas series de tiempo grabadas a intervalos igualmente espaciados, porque las series de tiempo que analizamos en ordenadores digitales son generalmente series de tiempo discretas.</p></li>
<li><p><strong>Series de tiempo univariadas y multivariadas</strong>. Las series de tiempo que consisten en una sola observación en cada punto temporal, como se muestran en los ejemplos 1.1, 1.2, 1.3 y 1.5, se denominan series de tiempo univariadas. Por otra parte, las series de tiempo que se obtienen grabando simultáneamente dos o más fenómenos como los ilustrados en el ejemplo 1.4 se denominan series de tiempo multivariadas. Sin embargo, puede ser difícil distinguir entre series de tiempo univariadas y multivariadas desde su naturaleza; más bien, la distinción se hace desde el punto de vista del analista y por varios otros factores, como la restricción de la medición y los conocimientos empíricos o teóricos sobre el tema. Desde el punto de vista del modelado estadístico, la selección de variables en sí misma es un problema importante en el análisis de series de tiempo.</p></li>
<li><p><strong>Series de tiempo estacionarias y no estacionarias</strong>. Una serie de tiempo es un registro de un fenómeno que varía irregularmente con el tiempo. En el análisis de series de tiempo, las series de tiempo de variación irregular se expresan generalmente mediante modelos estocásticos. En algunos casos, un fenómeno aleatorio puede ser considerado como la realización de un modelo estocástico con una estructura de variación temporal. Estas series de tiempo se denominan series de tiempo estacinarias. El ejemplo 1.5 es un ejemplo típico de una serie de tiempo estacionaria. Por otra parte, si la estructura estocástica de una serie de tiempo cambia con el tiempo, se denomina serie de tiempo no estacionaria. Como ejemplos típicos de series de tiempo no estacionarias, considere la serie en los ejemplos 1.1 a 1.4 . Se puede observar que los valores medios cambian a lo largo del tiempo.</p></li>
<li><p><strong>Series de tiempo gaussianas y no gaussianas</strong>. Cuando una distribución de una serie de tiempo sigue una distribución normal, la serie de tiempo se denomina serie de tiempo gaussiana; de lo contrario, se denomina serie de tiempo no gausiana. La mayoría de los modelos considerados en este libro son modelos gaussianos, asumiendo que las series de tiempo siguen distribuciones gaussianas. Al igual que en el caso del ejemplo 1.3, el patrón de las series de tiempo es a veces asimétrico, de modo que la distribución marginal no puede considerarse gaussiana. Incluso en tal situación, podemos obtener una serie de tiempo gaussiana aproximada mediante una transformación de datos apropiada.</p></li>
<li><p><strong>Series de tiempo lineales y no lineales</strong>. Una serie de tiempo expresable como la salida de un modelo lineal se denomina serie de tiempo lineal. Por el contrario, la salida de un modelo no lineal se denomina serie de tiempo no lineal.</p></li>
<li><p><strong>Datos faltantes y valores atípicos</strong>. En el modelado de series de tiempo de problemas del mundo real, a veces necesitamos tratar con observaciones faltante y valores atípicos. Algunos valores de las series de tiempo que no se han registrado por algunas razones se denominan observaciones que faltan en las series de tiempo. Los valores atípicos (observaciones exteriores) pueden ocurrir debido al comportamiento extraordinario del objeto, mal funcionamiento del dispositivo de observación o errores en el registro. En los datos de los ejemplos 1.4 y 1.5 se pueden observar datos atípicos. En el ejemplo 1.4 podemos notar caídas en los índices del DowJones y en el ejemplo 1.4 podemos notar una fuerte caída en el porcentaje de cambio de diario ocurrido el 19 de octubre de 1987.</p></li>
</ul>
</div>
</div>
<div id="componentes-de-una-serie-de-tiempo" class="section level2">
<h2><span class="header-section-number">1.3</span> Componentes de una serie de tiempo</h2>
<p>El análisis clásico de las series de tiempo se basa en la suposición de que los valores que toma la variable de observación es la consecuencia de tres componentes, cuya actuación conjunta da como resultado los valores medidos, estos componentes son:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Componente de tendencia</strong>. Se puede definir como un cambio a largo plazo que se produce en la relación al nivel medio, o el cambio a largo plazo de la media. La tendencia se identifica con un movimiento suave de la serie a largo plazo.</p></li>
<li><p><strong>Componente estacional</strong>. Muchas series de tiempo presentan cierta periodicidad o dicho de otro modo, variación de cierto período (semestral, mensual, etc.). Por ejemplo las Ventas al Detalle en Puerto Rico aumentan por los meses de noviembre y diciembre por las festividades navideñas. Estos efectos son fáciles de entender y se pueden medir explícitamente o incluso se pueden eliminar de la serie de datos, a este proceso se le llama desestacionalización de la serie.</p></li>
<li><p><strong>Componente aleatoria</strong>. Esta componente no responde a ningún patrón de comportamiento, sino que es el resultado de factores fortuitos o aleatorios que inciden de forma aislada en una serie de tiempo.</p></li>
</ol>
<p>De los tres componentes anteriores los dos primeros son componentes determinísticos, mientras que la última es aleatoria.</p>
<p>Los modelos que se utilizan con más frecuencia son:</p>
<ul>
<li><p><strong>Modelo aditivo</strong>: <span class="math inline">\(X_t=T_t+E_t+\epsilon_t\)</span></p></li>
<li><p><strong>Modelos multiplicativos</strong>:</p>
<ul>
<li><p><em>Puro</em>: <span class="math inline">\(X_t = T_t\times E_t\times\epsilon_t\)</span></p></li>
<li><p><em>Mixto</em>: <span class="math inline">\(X_t = T_t\times E_t+\epsilon_t\)</span></p></li>
</ul></li>
</ul>
<p>La elección de uno de estos modelos se hará de manera que el modelo seleccionado sea capaz de agrupar las principales características observadas en el gráfico de la serie en estudio.</p>
<div id="el-modelo-aditivo-de-componentes-de-series-de-tiempo" class="section level3">
<h3><span class="header-section-number">1.3.1</span> El Modelo Aditivo de Componentes de Series de Tiempo</h3>
Dada una serie <span class="math inline">\(X_t, t=1,\ldots,n\)</span>, el <em>Modelo Aditivo de Componentes</em> consiste en asumir que <span class="math inline">\(X_t\)</span> se puede descomponer en tres componentes:
<span class="math display" id="eq:eq-modelo-aditivo">\[\begin{equation}
X_t = T_t+E_t+\epsilon_t
\tag{1.1}
\end{equation}\]</span>
<p>donde <span class="math inline">\(T_t\)</span> es la componente de tendencia, <span class="math inline">\(E_t\)</span> es la componente estacional y <span class="math inline">\(\epsilon_t\)</span> es la componente aleatoria o de errores. Las componentes <span class="math inline">\(T_t\)</span> y <span class="math inline">\(E_t\)</span> son funciones de <span class="math inline">\(t\)</span> determinísticas. Su evolución es perfectamente predecible.</p>
<p>Este modelo es apropiado cuando la magnitud de la fluctuaciones estacionales de la serie no varía al hacerlo la tendencia.</p>
<p>La componente <span class="math inline">\(T_t\)</span> en algunos casos también puede ser una componente estacional, pero de baja frecuencia, o, equivalentemente, una componente con período muy grande. Por ejemplo, en una serie diaria, <span class="math inline">\(E_t\)</span> puede tener período 30 días, y <span class="math inline">\(T_t\)</span> período 360 días.</p>
<p>En la Figura  se muestra la idea de la descomposición. Al superponer las series en los gráficos (a), (b) y (c) se obtiene la serie en el gráfico (d).</p>
<p><img src="images/Grafica-tema3-modelo-aditivo.png" style="display: block; margin: auto;" /></p>
<p>Asumiendo el modelo aditivo, el análisis de series de tiempo consiste en modelar y estimar <span class="math inline">\(T_t\)</span> y <span class="math inline">\(E_t\)</span> y luego extraerlas de <span class="math inline">\(X_t\)</span> para obtener <span class="math inline">\(\hat{\epsilon}_t = X_t - \hat{T}_t - \hat{E}_t\)</span>. La serie <span class="math inline">\(\hat{\epsilon}_t\)</span> se modela y estima para finalmente reconstruír <span class="math inline">\(X_t\)</span>, <span class="math inline">\(\hat{X}_t = \hat{T}_t+\hat{E}_t+\hat{\epsilon}_t\)</span>, y poder realizar el pronóstico <span class="math inline">\(\hat{X}_{t+h}=\hat{T}_{t+h}+\hat{E}_{t+h}+\hat{\epsilon}_{t+h}\)</span>, utilizando la información disponible <span class="math inline">\(X_t,\ldots,X_n\)</span> con <span class="math inline">\(h=1,2,\ldots,m\)</span>. Sin embargo, puede suceder que la serie <span class="math inline">\(\hat{\epsilon}_t\)</span> sea incorrelacionada, es decir, <span class="math inline">\(Corr(\hat{\epsilon}_t,\hat{\epsilon}_{t+s}) = 0\)</span>, para <span class="math inline">\(s\neq0\)</span>. En este caso <span class="math inline">\(\hat{\epsilon}_{t+h}=0\)</span> para todo <span class="math inline">\(h&gt;0\)</span>.</p>
</div>
<div id="el-modelo-multiplicativo-de-componentes-de-series-de-tiempo" class="section level3">
<h3><span class="header-section-number">1.3.2</span> El Modelo Multiplicativo de Componentes de Series de Tiempo</h3>
<p>Dada una serie de tiempo <span class="math inline">\(X_t,t=1,\ldots,n\)</span>, el <em>Modelo Multiplicativo de Componentes</em> consiste en asumir que <span class="math inline">\(X_t\)</span> se puede descomponer de una de las siguientes maneras:</p>
<ul>
<li><em>Puro</em>:
<span class="math display" id="eq:eq-modelo-multiplicativo-puro">\[\begin{equation}
X_t = T_t\times E_t\times\epsilon_t
\tag{1.2}
\end{equation}\]</span></li>
<li><em>Mixto</em>:
<span class="math display" id="eq:eq-modelo-multiplicativo-mixto">\[\begin{equation}
X_t = T_t\times E_t+\epsilon_t
\tag{1.3}
\end{equation}\]</span></li>
</ul>
<p>donde <span class="math inline">\(T_t\)</span> es la componente de tendencia, <span class="math inline">\(E_t\)</span> es la componente estacional y <span class="math inline">\(\epsilon_t\)</span> es la componente aleatoria o de errores. Estos modelos son apropiados cuando la magnitud de las fluctuaciones estacionales de la serie crece y decrece proporcionalmente con los crecimientos y decrecimientos de la tendencia respectivamente.</p>

<div class="definition">
<span id="def:defi-tendencia" class="definition"><strong>Definición 1.3  </strong></span>La <strong>tendencia</strong>, se define como una función <span class="math inline">\(T_t\)</span> de <span class="math inline">\(t\)</span> que describe la evolución lenta y a largo plazo del nivel medio de la serie. La función <span class="math inline">\(T_t\)</span> depende de parámetros, que deben estimarse.
</div>

<p>A continuación presentamos una lista de posibles modelos para la tendencia <span class="math inline">\(T_t\)</span>:</p>
<ul>
<li>Lineal
<span class="math display" id="eq:eq-modelo-lineal">\[\begin{equation}
T_t=\beta_0+\beta_1t
\tag{1.4}
\end{equation}\]</span></li>
<li>Cuadrático
<span class="math display" id="eq:eq-modelo-cuadratico">\[\begin{equation}
T_t=\beta_0+\beta_1t+\beta_2t^2
\tag{1.5}
\end{equation}\]</span></li>
<li>Cúbico
<span class="math display" id="eq:eq-modelo-cubico">\[\begin{equation}
T_t=\beta_0+\beta_1t+\beta_2t^2+\beta_3t^3
\tag{1.6}
\end{equation}\]</span></li>
<li>Exponencial
<span class="math display" id="eq:eq-modelo-exponencial">\[\begin{equation}
T_t=\exp(\beta_0+\beta_1t)
\tag{1.7}
\end{equation}\]</span></li>
<li>Logístico
<span class="math display" id="eq:eq-modelo-logistico">\[\begin{equation}
T_t=\frac{\beta_2}{1+\beta_1\exp(-\beta_0t)}
\tag{1.8}
\end{equation}\]</span></li>
</ul>
<p>En la tendencia cuadrática podemos observar:</p>
<ul>
<li>Si <span class="math inline">\(\beta_1,\beta_2&gt;0\)</span>, <span class="math inline">\(T_t\)</span> es monótona creciente.</li>
<li>Si <span class="math inline">\(\beta_1,\beta_2&lt;0\)</span>, <span class="math inline">\(T_t\)</span> es monótona decreciente.</li>
<li>Si <span class="math inline">\(\beta_1&gt;0\)</span> y <span class="math inline">\(\beta_2&lt;0\)</span>, <span class="math inline">\(T_t\)</span> es cóncava.</li>
<li>Si <span class="math inline">\(\beta_1&lt;0\)</span> y <span class="math inline">\(\beta_2&gt;0\)</span>, <span class="math inline">\(T_t\)</span> es convexa.</li>
</ul>

<div class="definition">
<span id="def:defi-modelo-log-lineal" class="definition"><strong>Definición 1.4  </strong></span>El modelo <strong>Logarítmico Lineal</strong> o <strong>Log-Lineal</strong> se define como
<span class="math display" id="eq:eq-modelo-log-lineal">\[\begin{equation}
\ln X_t = \beta_0+\beta_1t + \epsilon_t
\tag{1.9}
\end{equation}\]</span>
</div>

<p>Corresponde a un modelo con tendencia lineal para el logaritmo de <span class="math inline">\(X_t\)</span>. En <a href="introduccion.html#eq:eq-modelo-log-lineal">(1.9)</a> al tomar exponencial se tiene <span class="math inline">\(X_t = \exp(\beta_0+\beta_1t + \epsilon_t)\)</span>, que es similar al modelo con tendencia exponencial <a href="introduccion.html#eq:eq-modelo-exponencial">(1.7)</a>. Sin embargo, son modelos diferentes y se estiman por métodos diferentes.</p>
</div>
</div>
<div id="estimacion-de-la-tendencia" class="section level2">
<h2><span class="header-section-number">1.4</span> Estimación de la Tendencia</h2>
<p>En esta sección introducimos la estimación de la tendencia mediante modelos de regresión lineal y no lineal. Son modelos paramétricos. También introduciremos modelos no paramétricos para estimar la tendencia, como los suavizadores, los filtros lineales y no lineales y las medias móviles. Hay otros métodos que no consideraremos en este curso, por ejemplo, <em>wavelets</em>. En ocasiones la expresión “suavizar una serie” es equivalente a “extracción de la tendencia de una serie”, y ambas equivalen a la estimación de la tendencia.</p>
<p>Para la estimación de los parámetros <span class="math inline">\(\beta_0,\beta_1,\beta_2\)</span> en los modelos lineales <a href="introduccion.html#eq:eq-modelo-lineal">(1.4)</a>, <a href="introduccion.html#eq:eq-modelo-cuadratico">(1.5)</a>, <a href="introduccion.html#eq:eq-modelo-cubico">(1.6)</a> y <a href="introduccion.html#eq:eq-modelo-log-lineal">(1.9)</a> utilizaremos el método de mínimos cuadrados clásico (MCC). En este método los parámetros estimados son aquellos que producen el valor mínimo de la suma de errores cuadrados. Para los modelos <a href="introduccion.html#eq:eq-modelo-exponencial">(1.7)</a> y <a href="introduccion.html#eq:eq-modelo-logistico">(1.8)</a> se usa el método de mínimos cuadrados no lineales, que también minimiza la suma de errores cuadrados.</p>
<p>El modelo Log-Lineal <a href="introduccion.html#eq:eq-modelo-log-lineal">(1.9)</a> es equivalente, algebráicamente, a <span class="math display">\[X_t = \exp(\beta_0 + \beta_1t + \epsilon_t).\]</span> Sin embargo, este último modelo es no lineal y no coincide con el modelo exponencial,<a href="introduccion.html#eq:eq-modelo-exponencial">(1.7)</a>, <span class="math inline">\(X_t = \exp(\beta_0+\beta_1t)+\epsilon_t\)</span>. Es posible estimar por mínimos cuadrados ordinarios el modelo Log-Lineal y utilizar los parámetros estimados <span class="math inline">\(\hat{\beta}_0,\hat{\beta}_1\)</span> como valores iniciales en la estimación del modelo exponencial por mínimos cuadrados no lineales. Pero los parámetros estimados en ambos modelos no necesariamente coinciden.</p>
<p>Aunque la serie tenga una componente estacional <span class="math inline">\(E_t\)</span>, <span class="math inline">\(X_t = T_t + E_t + \epsilon_t\)</span>, solamente consideramos un modelo de regresión entre <span class="math inline">\(X_t\)</span> y <span class="math inline">\(T_t\)</span>, tal que <span class="math inline">\(X_t = T_t + \eta_t\)</span>, donde <span class="math inline">\(\eta_t\)</span> es el término de error, de forma que <span class="math inline">\(\eta_t=E_t+\epsilon_t\)</span>. Por ejemplo,</p>
<ol style="list-style-type: decimal">
<li>En el caso lineal <span class="math inline">\(T_t = \beta_0 + \beta_1t\)</span>, ajustamos el modelo de regresión lineal: <span class="math inline">\(X_t = \beta_0 + \beta_1t + \eta_t\)</span>.</li>
<li>En el caso cuadrático <span class="math inline">\(T_t = \beta_0 +\beta_1t+\beta_2t^2\)</span>, ajustamos el modelo de regresión cuadrático <span class="math inline">\(X_t = \beta_0+\beta_1t+\beta_2t^2 +\eta_t\)</span>. Nótese que en este caso hay que definir una variable explicativa adicional <span class="math inline">\(t^2\)</span>.</li>
</ol>
<p>En general, para que datos de series de tiempo sean estacionarias, es necesario hacer un promedio de productos en el tiempo. Como para datos de serie de tiempo es importante medir la dependencia entre los valores de la serie; al menos, debemos ser capaces de estimar las autocorrelaciones con precisión. Será difícil medir la dependencia de estos valores si la estructura de dependencia no es regular o si cambia en el tiempo. De ahí, que para realizar cualquier análisis estadístico significativo de datos de series de tiempo, será crucial que las funciones de media y autocovarianza satisfagan las condiciones de estacionaridad dadas en la Definición 2.4.2. A menudo, este no es el caso, y en esta sección daremos algunos métodos para lidiar con los efectos de no-estacionaridad sobre las propiedades estacionarias de las series a estudiar.</p>
<p>Varios de los ejemplos vistos son claramente no estacionarios. La serie Johnson &amp; Johnson en la Figura 2.1 (Tema 2) tiene media que crece exponencialmente en el tiempo, y el incremento de la magnitud de fluctuación alrededor de su tendencia causa que la función de autocovarianza cambie. También, la serie de temperatura global que se muestra en la Figura 2.2 (Tema 2) contiene evidencia de alguna tendencia en el tiempo; el calentamiento global es de forma empírica inducida por el hombre.</p>
<p>Quizás la forma más fácil de trabajar con series no-estacionarias es el modelo de tendencia estacionaria donde el proceso tiene comportamiento estacionario alrededor de una tendencia. Podemos escribir este tipo de modelos como</p>
<span class="math display" id="eq:eq-modelo-tendencia-estacionaria">\[\begin{equation}
X_t=T_t+Y_t
\tag{1.10}
\end{equation}\]</span>
<p>donde <span class="math inline">\(X_t\)</span> son las observaciones, <span class="math inline">\(T_t\)</span> denota la tendencia y <span class="math inline">\(Y_t\)</span> es un proceso estacionario.</p>
<p>Por lo general, una tendencia fuerte <span class="math inline">\(T_t\)</span> puede oscurecer el comportamiento del proceso estacionario <span class="math inline">\(Y_t\)</span>, como veremos en ejemplos posteriores. De aquí, será una ventaja el que podamos remover la tendencia como un primer paso para un análisis exploratorio de los datos. Los pasos envuelven obtener un estimador razonable del componente de tendencia, llamémoslo <span class="math inline">\(\hat{T}_t\)</span> y entonces trabajar con el residual</p>
<span class="math display" id="eq:eq-estimacion-componente-tendencia">\[\begin{equation}
\hat{Y}_t=X_t-\hat{T}_t.
\tag{1.11}
\end{equation}\]</span>
<p>El primer paso en el análisis de cualquier tipo de serie es un gráfico de los datos.</p>
<ul>
<li><p>Si existe alguna aparente discontinuidad en la serie, tal como un cambio súbito en el nivel de la serie, esto puede darnos una idea para el análisis de la serie, un primer paso sería dividir la serie en segmentos homogéneos.</p></li>
<li><p>Si existen observaciones o datos “<em>outliers</em>”, estos deben ser estudiados con cuidado para verificar si existe alguna justificación para descartar estas observaciones, como por ejemplo si una observación ha sido registrada de algún otro proceso por error.</p></li>
<li><p>La inspección del gráfico también podría sugerir la representación de los datos como una realización de un proceso, como el modelo clásico de descomposición dado por <a href="introduccion.html#eq:eq-modelo-aditivo">(1.1)</a>.</p></li>
</ul>
<p>Si la componente estacional y la componente aleatoria o ruido parecen incrementarse con el nivel del proceso entonces una transformación preliminar de los datos es a menudo usada para hacer que los datos transformados sean compatibles con el modelo <a href="introduccion.html#eq:eq-modelo-aditivo">(1.1)</a>. En esta sección discutiremos algunas técnicas para identificar y eliminar las componentes en @ref(eq:eq-modelo-aditivo}).</p>
<p>Nuestro objetivo es estimar y extraer las componentes determinísticas <span class="math inline">\(T_t\)</span> y <span class="math inline">\(E_t\)</span> con la esperanza de que el residual o la componente aleatoria <span class="math inline">\(\epsilon_t\)</span> llegue a ser un proceso estacionario. Entonces podremos usar la teoría de tales procesos para hallar un modelo probabilístico satisfactorio para el proceso <span class="math inline">\(\epsilon_t\)</span>, analizar sus propiedades y usarlo en conjunto con <span class="math inline">\(T_t\)</span> y <span class="math inline">\(E_t\)</span> para hacer pronósticos y control de <span class="math inline">\(X_t\)</span>.</p>
<p>Los dos enfoques para la eliminación de las componentes de tendencia y estacional son:</p>
<ol style="list-style-type: decimal">
<li>Estimación de <span class="math inline">\(T_t\)</span> y <span class="math inline">\(E_t\)</span> en el modelo <a href="introduccion.html#eq:eq-modelo-aditivo">(1.1)</a>,</li>
<li>Diferencia de los datos <span class="math inline">\(X_t\)</span>.</li>
</ol>
<p>Ilustraremos ambos enfoque con varios ejemplos</p>
<div id="eliminacion-de-la-tendencia-en-ausencia-de-estacionalidad" class="section level3">
<h3><span class="header-section-number">1.4.1</span> Eliminación de la tendencia en ausencia de estacionalidad</h3>
En ausencia de la componente estacional <span class="math inline">\(E_t\)</span> el modelo <a href="introduccion.html#eq:eq-modelo-aditivo">(1.1)</a> llega ser
<span class="math display" id="eq:eq-modelo-tendencia">\[\begin{equation}
X_t = T_t + \epsilon_t,\quad t=1,\ldots,n
\tag{1.12}
\end{equation}\]</span>
<p>donde, sin perdida de generalidad, podemos asumir que <span class="math inline">\(E(\epsilon_t)=0\)</span>.</p>
<ol style="list-style-type: decimal">
<li><strong>Método T1: Estimación de <span class="math inline">\(T_t\)</span> por mínimos cuadrados</strong>. En este procedimiento intentamos ajustar una familia paramétrica de funciones como vimos en la sección~, a los datos eligiendo los parámetros que minimicen <span class="math inline">\(\sum_t(X_t-T_t)^2\)</span>.</li>
</ol>

<div class="example">
<span id="exm:ejem-metodo-T1" class="example"><strong>Ejemplo 1.6  </strong></span>Ajustando una función de la forma <a href="introduccion.html#eq:eq-modelo-cuadratico">(1.5)</a> para la población de los datos en el gráfico  para <span class="math inline">\(1790\leq t\leq1980\)</span> nos da los parámetros estimados <span class="math display">\[\hat{a}_0=2.0978;\quad \hat{a}_1=2.3349\times10^{-3}; \hat{a}_2=6.4984\times10^{-7}.\]</span> En el gráfico  se puede observar la curva ajustada y los datos originales. Los valores estimados del proceso de ruido <span class="math inline">\(\epsilon_t, 1790\leq t\leq1980\)</span>, son los residuales obtenidos por sustracción de <span class="math inline">\(\hat{T}_t=\hat{a}_0+\hat{a}_1t+\hat{a}_2t^2\)</span> de la serie <span class="math inline">\(X_t\)</span>. La componente de tendencia <span class="math inline">\(T_t\)</span> nos proporciona un predictor natural de los valores futuros de <span class="math inline">\(X_t\)</span>. Por ejemplo si deseamos estimar <span class="math inline">\(\epsilon_{1990}\)</span> por su valor medio, obtenemos <span class="math display">\[T_{1990} = 2.7588\times10^8\]</span> para la población de EE.UU en 1990. Sin embargo si los residuales <span class="math inline">\(\hat{\epsilon}_t\)</span> están altamente correlacionados podemos ser capaces de usar esos valores para dar una mejor estimación de <span class="math inline">\(\epsilon_{1990}\)</span> y por consiguiente de <span class="math inline">\(X_{1990}\)</span>.
</div>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">uspop=<span class="kw">ts</span>(<span class="kw">scan</span>(<span class="st">&quot;data/USPOP.txt&quot;</span>),<span class="dt">frequency=</span><span class="dv">1</span><span class="op">/</span><span class="dv">10</span>,<span class="dt">start=</span><span class="dv">1790</span>)
pop=<span class="kw">window</span>(uspop,<span class="dt">start=</span><span class="dv">1790</span>)
x=<span class="kw">time</span>(pop)
reg=<span class="kw">lm</span>(pop<span class="op">~</span>x<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>),<span class="dt">na.action=</span><span class="ot">NULL</span>)
<span class="kw">summary</span>(reg)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pop ~ x + I(x^2), na.action = NULL)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -6947521  -358167   436285  1481410  3391761 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.10e+10   6.59e+08    31.9   &lt;2e-16 ***
## x           -2.34e+07   6.98e+05   -33.5   &lt;2e-16 ***
## I(x^2)       6.51e+03   1.85e+02    35.2   &lt;2e-16 ***
## ---
## Signif. codes:  
## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2770000 on 18 degrees of freedom
## Multiple R-squared:  0.999,  Adjusted R-squared:  0.999 
## F-statistic: 8.05e+03 on 2 and 18 DF,  p-value: &lt;2e-16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(pop,<span class="dt">type=</span><span class="st">&quot;o&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Poblacion (millones)&quot;</span>)
<span class="kw">curve</span>(reg<span class="op">$</span>coefficient[<span class="dv">1</span>]<span class="op">+</span>reg<span class="op">$</span>coefficient[<span class="dv">2</span>]<span class="op">*</span>x<span class="op">+</span>reg<span class="op">$</span>coefficient[<span class="dv">3</span>]<span class="op">*</span>x<span class="op">^</span><span class="dv">2</span>,
      <span class="dt">add=</span>T,<span class="dt">col=</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="Serie-de-Tiempo-en-R_files/figure-html/unnamed-chunk-14-1.svg" /><!-- --></p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Método T2: Suavizado por medio de un promedio móvil</strong>. Sea <span class="math inline">\(q\)</span> un entero no negativo y consideremos un promedio móvil de la forma
<span class="math display" id="eq:eq-promedio-movil-orden-q">\[\begin{equation}
W_t = \frac{1}{2q+1}\sum_{j=-q}^{q}X_{t+j}
\tag{1.13}
\end{equation}\]</span>
de un proceso <span class="math inline">\(\{X_t\}\)</span> definido por <a href="introduccion.html#eq:eq-modelo-tendencia">(1.12)</a>. Entonces para <span class="math inline">\(q+1\leq t\leq n-q\)</span>,
<span class="math display" id="eq:eq-media-promedio-movil">\[\begin{eqnarray}
W_t &amp;=&amp; \frac{1}{2q+1}\sum_{j=-q}^qT_{t+j}+\frac{1}{2q+1}\sum_{j=-q}^q\epsilon_{t+j}\\ \nonumber
    &amp;\simeq&amp; T_t \tag{1.14}
\end{eqnarray}\]</span>
suponiendo que <span class="math inline">\(T_t\)</span> es aproximadamente lineal sobre el intervalo <span class="math inline">\([t-q,t+q]\)</span> y que el promedio del término de error sobre este intervalo es cercano a cero.</li>
</ol>
El promedio móvil entonces nos provee con el estimador
<span class="math display" id="eq:eq-estimador-promedio-movil">\[\begin{equation}
      \hat{T}_t = \frac{1}{2q+1}\sum_{j=-q}^qX_{t+j},\quad q+1\leq t\leq n-q.
\tag{1.15}
\end{equation}\]</span>
<p>Dado que <span class="math inline">\(X_t\)</span> es no observado para <span class="math inline">\(t\leq0\)</span> o <span class="math inline">\(t\geq n\)</span> no podemos usar () para <span class="math inline">\(t\leq q\)</span> o <span class="math inline">\(t&gt;n-q\)</span>. Una forma de resolver este problema es haciendo <span class="math inline">\(X_t=X_1\)</span> para <span class="math inline">\(t&lt;1\)</span> y <span class="math inline">\(X_t=X_n\)</span> para <span class="math inline">\(t&gt;n\)</span>. A continuación presentamos un ejemplo</p>

<div class="example">
<p><span id="exm:ejem-huelgas-USA" class="example"><strong>Ejemplo 1.7  </strong></span>El gráfico siguiente muestra las huelgas ocurridas en EE.UU, de 1951 a 1980, según la Oficina de Estadísticas Laborales del Departamento de Trabajo de los EE.UU.</p>
<p>A estos datos le aplicamos un promedio móvil de 5 puntos, la Figura muestra la serie suavizada y el término de error estimado <span class="math inline">\(\hat{\epsilon}_t = X_t - \hat{T}_t\)</span> se muestra en la Figura . Como era de esperarse ellos no presentan una tendencia clara.</p>
Las instrucciones en R para el suavizado y los gráficos son los siguientes:
</div>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">H=<span class="kw">read.table</span>(<span class="st">&quot;data/Huelgas.txt&quot;</span>)
<span class="kw">plot</span>(H,<span class="dt">xlab=</span><span class="st">&quot;anos&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Huelgas&quot;</span>,<span class="dt">type=</span><span class="st">&#39;b&#39;</span>)</code></pre></div>
<p><img src="Serie-de-Tiempo-en-R_files/figure-html/unnamed-chunk-15-1.svg" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">W=<span class="kw">filter</span>(H[,<span class="dv">2</span>],<span class="dt">sides=</span><span class="dv">2</span>,<span class="kw">rep</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">5</span>,<span class="dv">5</span>))
<span class="kw">plot</span>(H[,<span class="dv">1</span>],W,<span class="dt">xlab=</span><span class="st">&quot;anos&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Huelgas&quot;</span>,<span class="dt">type=</span><span class="st">&#39;b&#39;</span>)</code></pre></div>
<p><img src="Serie-de-Tiempo-en-R_files/figure-html/unnamed-chunk-15-2.svg" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y=H[,<span class="dv">2</span>]<span class="op">-</span>W
<span class="kw">plot</span>(H[,<span class="dv">1</span>],y,<span class="dt">xlab=</span><span class="st">&quot;anos&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Residuales&quot;</span>,<span class="dt">type=</span><span class="st">&#39;b&#39;</span>)</code></pre></div>
<p><img src="Serie-de-Tiempo-en-R_files/figure-html/unnamed-chunk-15-3.svg" /><!-- --></p>
Para cada valor fijo <span class="math inline">\(a\in[0,1]\)</span>, el promedio móvil de un lado <span class="math inline">\(\hat{T}_t, t=1,\ldots,n\)</span>, definido por la recursión
<span class="math display" id="eq:eq-promedio-movil-1-lado-peso">\[\begin{equation}
  \hat{T}_t = aX_t+(1-a)\hat{T}_t,\quad t=2,\ldots,n
 \tag{1.16}
\end{equation}\]</span>
<p>y</p>
<p><span class="math display">\[\hat{T}_1=X_1,\]</span> se puede calcular usando la opción <em>sides=1</em> en la función <em>filter</em> de R.</p>
<p>Es usual pensar como aplicación de la ecuación <a href="introduccion.html#eq:eq-promedio-movil-1-lado-peso">(1.16)</a> como un suavizado exponencial, dado que se sigue de la recursión que para <span class="math inline">\(t\leq2, \hat{T}_t=\sum_{j=0}^{t-2}a(1-a)^jX_{t-j}+(1-a)^{t-1}X_1\)</span>, es un promedio móvil con peso de <span class="math inline">\(X_t,X_{t-1},\ldots\)</span>, con pesos decreciendo exponencialmente (excepto para el último término).</p>
<p>Es útil pensar en <span class="math inline">\(\{\hat{T}_t\}\)</span> en (<em>filter</em>) como un proceso obtenido de <span class="math inline">\(\{X_t\}\)</span> por aplicación de un operador lineal o filtro lineal <span class="math inline">\(\hat{T}_t=\sum_{j=-\infty}^{\infty}a_jX_{t+j}\)</span> con pesos <span class="math inline">\(a_j=(2q+1)^{-1},-q\leq j\leq q\)</span>, y <span class="math inline">\(a_j=0,|j|&gt;q\)</span>. Este filtro particular es un filtro de “paso-bajo” ya que toma los datos <span class="math inline">\(\{X_t\}\)</span> y remueve la componente de rápida fluctuación (o de alta frecuencia) <span class="math inline">\(\{\hat{\epsilon}_t\}\)</span>, para dejar el término de la tendencia estimada de lenta variación <span class="math inline">\(\{\hat{T}_t\}\)</span>.</p>
<ul>
<li><strong>Método T3: Diferenciación para generar datos estacionarios</strong>. En lugar de intentar remover el ruido por suavizado como en el Método T2, ahora intentaremos eliminar la tendencia por diferenciación. Definamos primero el operador diferencia <span class="math inline">\(\nabla\)</span> por
<span class="math display" id="eq:eq-operador-diferencia">\[\begin{equation}
  \nabla x_t = x_t-x_{t-1}=(1-B)x_t,
\tag{1.17}
\end{equation}\]</span>
donde <span class="math inline">\(B\)</span> es el operador de desplazamiento hacia atrás (<em>backward shift operator</em> en inglés),
<span class="math display" id="eq:eq-backward-shift-operator">\[\begin{equation}
  Bx_t=x_{t-1}.
\tag{1.18}
\end{equation}\]</span>
Las potencias de los operadores <span class="math inline">\(B\)</span> y <span class="math inline">\(\nabla\)</span> se definen de manera obvia, esto es, <span class="math inline">\(B^j(x_t)=x_{t-j}\)</span> y <span class="math inline">\(\nabla^j(x_t)=\nabla(\nabla^{j-1}(x_t)),j\geq1\)</span> con <span class="math inline">\(\nabla^0(x_t)=x_t\)</span>. Los polinomios en <span class="math inline">\(B\)</span> y <span class="math inline">\(\nabla\)</span> se manipulan de la misma manera que las funciones polinómicas de variables reales. Por ejemplo
<span class="math display">\[\begin{eqnarray*}
  \nabla^2x_t &amp;=&amp; \nabla(\nabla x_t) = (1-B)(1-B)x_t = (1-2B+B^2)x_t \\
          &amp;=&amp; x_t-2x_{t-1}+x_{t-2}.
\end{eqnarray*}\]</span>
Si el operador <span class="math inline">\(\nabla\)</span> se aplica a una función con tendencia lineal <span class="math inline">\(T_t=at+b\)</span>, entonces obtenemos la función constante <span class="math inline">\(\nabla T_t=a\)</span>. De la misma manera cada tendencia polinomial de grado <span class="math inline">\(k\)</span> se puede reducir a una constante por aplicación del operador <span class="math inline">\(\nabla^k\)</span>.</li>
</ul>
<p>Iniciando entonces con el modelo <span class="math inline">\(X_t=T_t+\epsilon_t\)</span>, donde <span class="math inline">\(T_t=\sum_{j=0}^ka_jt^j\)</span> y <span class="math inline">\(\epsilon_t\)</span> es estacionario con media cero, obtenemos</p>
<p><span class="math display">\[\nabla^kX_t = k!a_k+\nabla^k\epsilon_t,\]</span> un proceso estacionario con media <span class="math inline">\(k!a_k\)</span>. Esta consideración sugiere la posibilidad, dada una sucesión <span class="math inline">\(\{X_t\}\)</span> de datos, de aplicar el operador <span class="math inline">\(\nabla\)</span> repetidamente hasta conseguir una sucesión <span class="math inline">\(\{\nabla^kX_t\}\)</span> la cual puede ser apropiadamente modelada como una realización de un proceso estacionario. Se encuentra a menudo en la práctica que el orden <span class="math inline">\(k\)</span> de diferenciación es bastante pequeño, frecuentemente uno o dos.</p>
<p>Aplicando esta técnica al ejemplo de los 20 datos de población de los EE.UU, hallamos que dos operaciones de diferenciación son suficientes para producir una serie sin aparente tendencia. Los datos diferenciados se muestran en la Figura . Note que la magnitud de las fluctuaciones en <span class="math inline">\(\nabla^2X_n\)</span> se incrementa con el valor de <span class="math inline">\(n\)</span>. Este efecto se puede suprimir tomando primero logaritmo natural, <span class="math inline">\(y_n=\ln X_n\)</span> y entonces aplicando el operador <span class="math inline">\(\nabla^2\)</span> a la serie <span class="math inline">\(\{y_n\}\)</span>.</p>
<p>Las instrucciones en R son las siguientes</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Dx=<span class="kw">diff</span>(uspop,<span class="dt">difference=</span><span class="dv">2</span>)</code></pre></div>
<!--
plot(Dx,type="ano", ylab="Población (millones)")
-->
</div>
</div>
<div id="eliminacion-de-la-tendencia-y-la-estacionalidad" class="section level2">
<h2><span class="header-section-number">1.5</span> Eliminación de la tendencia y la estacionalidad</h2>
Los métodos descritos para remover la tendencia pueden ser adaptados de manera natural para eliminar tanto la tendencia como la estacionalidad en el modelo general
<span class="math display">\[\begin{equation}
X_t = T_t + E_t + \epsilon_t
\end{equation}\]</span>
<p>donde <span class="math inline">\(E\epsilon_t=0, E_{t+d}=E_t\)</span> y <span class="math inline">\(\sum_{j=1}^dE_t=0\)</span>. Ilustraremos estos métodos con referencia al siguiente ejemplo de accidentes. En la Tabla~ se muestran los datos, y en la Figura~ podemos observar que en los mismos se ve claramente una componente estacional con periodo <span class="math inline">\(d=12\)</span>.</p>
<table>
<thead>
<tr class="header">
<th align="center">mes/año</th>
<th align="center">1973</th>
<th align="center">1974</th>
<th align="center">1975</th>
<th align="center">1976</th>
<th align="center">1977</th>
<th align="center">1978</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Ene</td>
<td align="center">9007</td>
<td align="center">7750</td>
<td align="center">8162</td>
<td align="center">7717</td>
<td align="center">7792</td>
<td align="center">7836</td>
</tr>
<tr class="even">
<td align="center">Feb</td>
<td align="center">8106</td>
<td align="center">6981</td>
<td align="center">7306</td>
<td align="center">7461</td>
<td align="center">6957</td>
<td align="center">6892</td>
</tr>
<tr class="odd">
<td align="center">Mar</td>
<td align="center">8928</td>
<td align="center">8038</td>
<td align="center">8124</td>
<td align="center">7776</td>
<td align="center">7726</td>
<td align="center">7791</td>
</tr>
<tr class="even">
<td align="center">Abr</td>
<td align="center">9137</td>
<td align="center">8422</td>
<td align="center">7870</td>
<td align="center">7925</td>
<td align="center">8106</td>
<td align="center">8129</td>
</tr>
<tr class="odd">
<td align="center">May</td>
<td align="center">10017</td>
<td align="center">8714</td>
<td align="center">9387</td>
<td align="center">8634</td>
<td align="center">8890</td>
<td align="center">9115</td>
</tr>
<tr class="even">
<td align="center">Jun</td>
<td align="center">10826</td>
<td align="center">9512</td>
<td align="center">9556</td>
<td align="center">8945</td>
<td align="center">9299</td>
<td align="center">9434</td>
</tr>
<tr class="odd">
<td align="center">Jul</td>
<td align="center">11317</td>
<td align="center">10120</td>
<td align="center">10093</td>
<td align="center">10078</td>
<td align="center">10625</td>
<td align="center">10484</td>
</tr>
<tr class="even">
<td align="center">Ago</td>
<td align="center">10744</td>
<td align="center">9823</td>
<td align="center">9620</td>
<td align="center">9179</td>
<td align="center">9302</td>
<td align="center">9827</td>
</tr>
<tr class="odd">
<td align="center">Sep</td>
<td align="center">9713</td>
<td align="center">8743</td>
<td align="center">8285</td>
<td align="center">8037</td>
<td align="center">8314</td>
<td align="center">9110</td>
</tr>
<tr class="even">
<td align="center">Oct</td>
<td align="center">9938</td>
<td align="center">9129</td>
<td align="center">8433</td>
<td align="center">8488</td>
<td align="center">8850</td>
<td align="center">9070</td>
</tr>
<tr class="odd">
<td align="center">Nov</td>
<td align="center">9161</td>
<td align="center">8710</td>
<td align="center">8160</td>
<td align="center">7874</td>
<td align="center">8265</td>
<td align="center">8633</td>
</tr>
<tr class="even">
<td align="center">Dic</td>
<td align="center">8927</td>
<td align="center">8680</td>
<td align="center">8034</td>
<td align="center">8647</td>
<td align="center">8796</td>
<td align="center">9240</td>
</tr>
</tbody>
</table>
<p>Accidentes mortales mensuales en EE.UU., años 1973-1978.</p>
<p>Será conveniente para el primer método indexar los datos por año y mes. Entonces <span class="math inline">\(X_{j,k}, j=1,\ldots,6, k=1,\ldots,12\)</span> denotará el número de muertes accidentales reportados para el <span class="math inline">\(k\)</span>-ésimo mes del <span class="math inline">\(j\)</span>-ésimo año, (1972+j). En otras palabras, definimos <span class="math display">\[X_{j,k}=X_{k+12(j-1)}, j=1,\ldots,6, k=1,\ldots,12.\]</span></p>
<ul>
<li><strong>Método E1: Método de la tendencia pequeña</strong>. Si la tendencia es pequeña (como en los datos de accidentes) no es irrazonable suponer que el término de la tendencia es constante, digamos <span class="math inline">\(T_j\)</span> para el año <span class="math inline">\(j\)</span>. Dado que <span class="math inline">\(\sum_{k=1}^{12}E_k=0\)</span>, nos lleva al estimador insesgado natural
<span class="math display" id="eq:eq-estimador-Tj-accidentes">\[\begin{equation}
\hat{T}_j = \frac{1}{12}\sum_{k=1}^{12}X_{j,k},
\tag{1.19}
\end{equation}\]</span>
mientras que para <span class="math inline">\(E_k, k=1,\ldots,12\)</span> tenemos el estimador
<span class="math display" id="eq:eq-estimador-Et-accidentes">\[\begin{equation}
\hat{E}_t = \frac{1}{6}\sum_{j=1}^6(X_{j,k}-\hat{T}_j),
\tag{1.20}
\end{equation}\]</span>
el cual automáticamente satisface el requisito de que <span class="math inline">\(\sum_{k=1}^{12}\hat{E}_k=0\)</span>. El término de error estimado para el mes <span class="math inline">\(k\)</span> del año <span class="math inline">\(j\)</span> es por supuesto
<span class="math display" id="eq:eq-estimador-epsilon-t-accidentes">\[\begin{equation}
\hat{\epsilon}_{j,k} = X_{j,k}-\hat{T}_j-\hat{E}_k, \quad j=1,\ldots,6,k1,\ldots,12.
\tag{1.21}
\end{equation}\]</span>
La generalización de () a () para datos con estacionalidad con un periodo distinto de 12 es bastante claro.</li>
</ul>
<p>Las Figuras ,  y  muestran respectivamente las observaciones con la tendencia removida <span class="math inline">\(X_{j,k}-\hat{T}_j\)</span>, la componente estacional estimada <span class="math inline">\(\hat{E}_t\)</span> y las observaciones con la tendencia y la estacionalidad removida <span class="math inline">\(\hat{\epsilon}_{j,k}=X_{j,k}-\hat{T}_j-\hat{E}_k\)</span>. En la última no se observa una aparente tendencia o estacionalidad.</p>
<ul>
<li><strong>Método E2: Estimación por promedio móvil</strong>. La siguiente técnica es preferible al Método S1 ya que no se basa en la suposición de que <span class="math inline">\(T_t\)</span> es casi constante sobre cada ciclo estacional.</li>
</ul>
Suponga que tenemos las observaciones <span class="math inline">\(\{x_1,\ldots,x_n\}\)</span>. Se estima primero la tendencia aplicando un filtro de promedio móvil especialmente elegido para eliminar la componente estacional y para amortiguar el ruido. Si el periodo <span class="math inline">\(d\)</span> es par, digamos <span class="math inline">\(d=2q\)</span>, entonces usamos
<span class="math display" id="eq:eq-filtro-especial-metodo-S2">\[\begin{equation}
\hat{T}_t = (0.5x_{t-q} + x_{t-q+1} + \cdots + x_{t+q-1} + 0.5x_{t+q})/d, q&lt;t\leq n-q.
\tag{1.22}
\end{equation}\]</span>
<p>Si el periodo es impar, digamos <span class="math inline">\(d=2q+1\)</span>, entonces usamos el promedio móvil simple (). La Figura~ muestra la tendencia estimada <span class="math inline">\(\hat{T}_t\)</span> para los datos de accidentes mortales obtenido de (). También muestra la tendencia constante a trozos obtenida por el Método S1.</p>
El segundo paso, es estimar la componente estacional. Para cada <span class="math inline">\(k=1,\ldots,d\)</span>, calculamos el promedio <span class="math inline">\(w_k\)</span> de las desviaciones <span class="math inline">\(\{(X_{k+jd}-\hat{T}_{k+jd}):q&lt;k+jd\leq n-q\}\)</span>. Dado que este promedio de desviaciones no necesariamente suma cero, estimamos la componente estacional <span class="math inline">\(E_k\)</span> como
<span class="math display" id="eq:eq-estimador-Et-metodo-S2">\[\begin{equation}
\hat{E}_k = w_k -\frac{1}{d}\sum_{i=1}^dw_i,\quad i=1,\ldots,d,
\tag{1.23}
\end{equation}\]</span>
<p>y <span class="math inline">\(\hat{E}_k=\hat{E}_{k-d},k&gt;d\)</span>.</p>
Los datos sin la componente estacional se definen entonces como la serie original con la componente estacional removida, es decir,
<span class="math display" id="eq:eq-serie-destacionalizada">\[\begin{equation}
d_t = X_t-\hat{E}_t,\quad t=1,\ldots,n.
\tag{1.24}
\end{equation}\]</span>
<p>Finalmente, reestimamos la tendencia de <span class="math inline">\(\{d_t\}\)</span> aplicando un filtro de promedio móvil como se describió para los datos no estacionales o fijando un polinomio a la serie <span class="math inline">\(\{d_t\}\)</span>. El término del ruido estimado llega a ser entonces</p>
<p><span class="math display">\[\hat{\epsilon}_t = X_t - \hat{E}_t - \hat{E}_t, \quad t=1,\ldots,n.\]</span> Los resultados de aplicar los Métodos S1 y S2 a los datos de accidentes mortales son casi iguales, dado que en este caso la constante a trozos y el promedio móvil de <span class="math inline">\(T_t\)</span> están razonablemente cercanos.</p>
<p>Una comparación de los valores estimados de <span class="math inline">\(E_k, k=1,\ldots,12\)</span>, obtenido con ambos métodos se muestra en la Tabla~</p>
<table>
<thead>
<tr class="header">
<th align="center">k</th>
<th align="center">1</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
<th align="center">5</th>
<th align="center">6</th>
<th align="center">7</th>
<th align="center">8</th>
<th align="center">9</th>
<th align="center">10</th>
<th align="center">11</th>
<th align="right">12</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{E}_t(S1)\)</span></td>
<td align="center">-7434</td>
<td align="center">-1504</td>
<td align="center">-724</td>
<td align="center">-523</td>
<td align="center">338</td>
<td align="center">808</td>
<td align="center">1665</td>
<td align="center">961</td>
<td align="center">-87</td>
<td align="center">197</td>
<td align="center">-321</td>
<td align="right">-67</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\hat{E}_t(S2)\)</span></td>
<td align="center">-804</td>
<td align="center">-1522</td>
<td align="center">-737</td>
<td align="center">-526</td>
<td align="center">343</td>
<td align="center">746</td>
<td align="center">1680</td>
<td align="center">987</td>
<td align="center">-109</td>
<td align="center">258</td>
<td align="center">-259</td>
<td align="right">-57</td>
</tr>
</tbody>
</table>
<p>Componentes estacional estimadas para los datos de accidentes mortales</p>
<ul>
<li><strong>Método E3: Diferenciación a paso <span class="math inline">\(\mathbf{d}\)</span></strong>. La técnica de diferenciación la cual aplicamos antes a datos no estacionales se pueden adaptar para lidiar con el caso estacional de periodo <span class="math inline">\(d\)</span> introduciendo el operador de diferencia de paso <span class="math inline">\(d\)</span> <span class="math inline">\(\nabla_d\)</span> definido por
<span class="math display" id="eq:eq-operador-diferencia-paso-d">\[\begin{equation}
\nabla_dX_t = X_t-X_{t-d} = (1-B^d)X_t.
\tag{1.25}
\end{equation}\]</span>
Este operador no debe confundirse con el operador <span class="math inline">\(\nabla^d = (1-B)^d\)</span> definido por ().</li>
</ul>
<p>Aplicando el operador <span class="math inline">\(\nabla_d\)</span> al modelo <span class="math display">\[X_t = T_t + E_t + \epsilon_t,\]</span> donde <span class="math inline">\(\{E_t\}\)</span> tiene periodo <span class="math inline">\(d\)</span>, obtenemos <span class="math display">\[\nabla_dX_t = T_t-T_{t-d} + \epsilon_t-\epsilon_{t-d},\]</span> lo cual nos da una descomposición de la diferencia <span class="math inline">\(\nabla_dX_t\)</span> en una componente de tendencia <span class="math inline">\((T_t-T_{t-d})\)</span> y un término de ruido <span class="math inline">\((\epsilon_t-\epsilon_{t-d})\)</span>. La tendencia <span class="math inline">\((T_t-T_{t-d})\)</span> se puede eliminar usando los métodos ya descritos, por ejemplo, aplicando alguna potencia del operador <span class="math inline">\(\nabla\)</span>. La Figura~ muestra el resultado de aplicar el operador <span class="math inline">\(\nabla_{12}\)</span> a los datos de accidentes mortales. La componente estacional evidente en la Figura~ está ausente en la Figura de <span class="math inline">\(\nabla_{12}X_t,13\leq t\leq72\)</span>. Sin embargo todavía parece haber una tendencia decreciente. Si ahora aplicamos el operador <span class="math inline">\(\nabla\)</span> a <span class="math inline">\(\nabla_{12}X_t\)</span> y graficamos las diferencias <span class="math inline">\(\nabla\nabla_{12}X_t,t=14,\ldots,72\)</span> obtenemos el gráfico mostrado en la Figura~, los cuales no tienen una aparente tendencia o componente estacional.</p>


</div>
</div>



</div>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-78759535-1', 'auto');
ga('send', 'pageview');  
</script>
            </section>

          </div>
        </div>
      </div>
<a href="acerca-del-autor.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="referencias.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/synergyvision/Teoria-de-Portafolio/edit/master/bookdown/010-introduccion.Rmd",
"text": "Edit"
},
"download": ["Serie-de-Tiempo-en-R.pdf"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
